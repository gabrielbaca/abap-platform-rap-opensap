# Instructor script
## Create database tables
1. Create package ZRAP_TRAVEL_SFMX
2. Add to favorites the parent package
3. Create travel database table ZRAP_ATRAV_SFMX
4. Replace code
    ```ABAP
    @EndUserText.label : 'Travel data'
    @AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
    @AbapCatalog.tableCategory : #TRANSPARENT
    @AbapCatalog.deliveryClass : #A
    @AbapCatalog.dataMaintenance : #RESTRICTED
    define table zrap_atrav_sfmx {
      key client            : mandt not null;
      key travel_uuid       : sysuuid_x16 not null;
      travel_id             : /dmo/travel_id;
      agency_id             : /dmo/agency_id;
      customer_id           : /dmo/customer_id;
      begin_date            : /dmo/begin_date;
      end_date              : /dmo/end_date;
      @Semantics.amount.currencyCode : 'zrap_atrav_sfmx.currency_code'
      booking_fee           : /dmo/booking_fee;
      @Semantics.amount.currencyCode : 'zrap_atrav_sfmx.currency_code'
      total_price           : /dmo/total_price;
      currency_code         : /dmo/currency_code;
      description           : /dmo/description;
      overall_status        : /dmo/overall_status;
      created_by            : syuname;
      created_at            : timestampl;
      last_changed_by       : syuname;
      last_changed_at       : timestampl;
      local_last_changed_at : timestampl;
    }
    ```
5. Create booking database table ZRAP_ABOOK_SFMX
6. Replace code
    ```ABAP
    @EndUserText.label : 'Booking data'
    @AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
    @AbapCatalog.tableCategory : #TRANSPARENT
    @AbapCatalog.deliveryClass : #A
    @AbapCatalog.dataMaintenance : #RESTRICTED
    define table zrap_abook_sfmx {
      key client            : mandt not null;
      key booking_uuid      : sysuuid_x16 not null;
      travel_uuid           : sysuuid_x16 not null;
      booking_id            : /dmo/booking_id;
      booking_date          : /dmo/booking_date;
      customer_id           : /dmo/customer_id;
      carrier_id            : /dmo/carrier_id;
      connection_id         : /dmo/connection_id;
      flight_date           : /dmo/flight_date;
      @Semantics.amount.currencyCode : 'zrap_abook_sfmx.currency_code'
      flight_price          : /dmo/flight_price;
      currency_code         : /dmo/currency_code;
      created_by            : syuname;
      last_changed_by       : syuname;
      local_last_changed_at : timestampl;
    }
    ```  
7. Save and activate.
8. Data preview (empty)
9. Create class ZCL_GENERATE_DEMO_DATA_SFMX
10. Replace code (Remember to refactor methods into delete and populate)
    ```ABAP
    METHOD if_oo_adt_classrun~main.

    " delete existing entries in the database table
    DELETE FROM zrap_atrav_sfmx.
    DELETE FROM zrap_abook_sfmx.

    " insert travel demo data
    INSERT zrap_atrav_sfmx FROM (
        SELECT FROM 
            /dmo/travel
        FIELDS
            uuid(  )      AS travel_uuid,
            travel_id     AS travel_id,
            agency_id     AS agency_id,
            customer_id   AS customer_id,
            begin_date    AS begin_date,
            end_date      AS end_date,
            booking_fee   AS booking_fee,
            total_price   AS total_price,
            currency_code AS currency_code,
            description   AS description,
            CASE status
              WHEN 'B' THEN 'A' " accepted
              WHEN 'X' THEN 'X' " cancelled
              ELSE 'O'          " open
            END           AS overall_status,
            createdby     AS created_by,
            createdat     AS created_at,
            lastchangedby AS last_changed_by,
            lastchangedat AS last_changed_at,
            lastchangedat AS local_last_changed_at
        ORDER BY 
            travel_id UP TO 200 ROWS
      ).
    COMMIT WORK.

    out->write( 'Travel demo data inserted.').

    " insert booking demo data
    INSERT zrap_abook_sfmx FROM (
        SELECT FROM   
            /dmo/booking AS booking
        JOIN 
            zrap_atrav_sfmx AS z ON   
            booking~travel_id = z~travel_id
          FIELDS
            uuid( )                 AS booking_uuid,
            z~travel_uuid           AS travel_uuid,
            booking~booking_id      AS booking_id,
            booking~booking_date    AS booking_date,
            booking~customer_id     AS customer_id,
            booking~carrier_id      AS carrier_id,
            booking~connection_id   AS connection_id,
            booking~flight_date     AS flight_date,
            booking~flight_price    AS flight_price,
            booking~currency_code   AS currency_code,
            z~created_by            AS created_by,
            z~last_changed_by       AS last_changed_by,
            z~last_changed_at       AS local_last_changed_by
      ).
    COMMIT WORK.

    out->write( 'Booking demo data inserted.').
    ENDMETHOD.
    ```
11. Save and activate.
12. Press F9 to run in console
13. Preview tables

##
